<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.ssafy.pjt.model.dao.BoardPostDao">
	<!-- 전체 게시글 조회 -->
	<select id="allPost" resultType="Post">
		SELECT *
		FROM board_post
	</select>

	<!-- 게시판별 게시글 조회 -->
	<select id="selectAll" parameterType="int" resultType="Post">
		SELECT *
		FROM board_post
		WHERE board_id = #{board_id};
	</select>

	<!-- 게시글 단어로 검색 -->
	<select id="selectByWord" parameterType="String"
		resultType="Post">
		SELECT *
		FROM board_post
		WHERE content LIKE CONCAT('%',
		#{word}, '%')
		OR title LIKE CONCAT('%', #{word}, '%')
	</select>

	<!-- 상세글 조회 -->
	<select id="selectOne" resultType="Post" parameterType="int">
		SELECT *
		FROM board_post
		WHERE id = #{id}
	</select>

	<!-- 게시글 등록 -->
	<insert id="insertPost" parameterType="Post" keyProperty="id"
		useGeneratedKeys="true">
		INSERT INTO board_post (board_id, title, user_id,
		content, image)
		VALUES (#{board_id}, #{title}, #{user_id}, #{content}, #{image})
	</insert>

	<!-- 게시글 수정 -->
	<!-- 컬럼이 등록 날짜만 관리를 하고 있다. -->
	<!-- 등록날짜 / 최근 조회날짜 / 수정 날짜 .... -->
	<update id="updatePost" parameterType="Post">
		UPDATE board_post
		SET
		reg_date = DATE_Format(now(), '%Y%m%d%H%i%s')
		, title = #{title}
		, content = #{content}
		WHERE id = #{id}
	</update>

	<!-- 게시글 삭제 -->
	<delete id="deletePost" parameterType="int">
		DELETE FROM board_post
		WHERE id = #{id}
	</delete>

	<!-- 리뷰 조회수 증가 -->
	<update id="updateViewCnt" parameterType="int">
		UPDATE board_post
		SET
		view_cnt = #{view_cnt} + 1
		WHERE id = #{id}
	</update>

</mapper>